<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>NMFS Open Science Resources - Best Coding Practices in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../content/best_practices_coding/testing_and_review.html" rel="next">
<link href="../../content/best_practices_coding/index.html" rel="prev">
<link href="../../images/favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Best Coding Practices in R</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="../../index.html" class="sidebar-logo-link">
      <img src="https://raw.githubusercontent.com/nmfs-opensci/assets/main/logo/nmfs-opensci-logo3.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main tools-wide">
    <a href="https://nmfs-opensci.github.io" title="NMFS Open Science" class="sidebar-tool px-1"><i class="bi bi-globe"></i></a>
    <a href="https://github.com/nmfs-opensci" title="nmfs-opensci" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">Home</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/welcome.html" class="sidebar-item-text sidebar-link">Welcome</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/code_of_conduct.html" class="sidebar-item-text sidebar-link">Code of Conduct</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/culture.html" class="sidebar-item-text sidebar-link">Culture and Philosophy</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/templates.html" class="sidebar-item-text sidebar-link">Templates</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/training.html" class="sidebar-item-text sidebar-link">NMFS R Workshops</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/github_in_gov.html" class="sidebar-item-text sidebar-link">GitHub in Government</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/landing_pages.html" class="sidebar-item-text sidebar-link">Landing Pages</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/documentation.html" class="sidebar-item-text sidebar-link">Documentation</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/licenses_gov.html" class="sidebar-item-text sidebar-link">Licenses for Government Work</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../content/best_practices_coding/index.html" class="sidebar-item-text sidebar-link">Coding Best Practices</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/best_practices_coding/best_practices_r.html" class="sidebar-item-text sidebar-link active">Best Coding Practices in R</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/best_practices_coding/testing_and_review.html" class="sidebar-item-text sidebar-link">Testing and Review</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../content/github/index.html" class="sidebar-item-text sidebar-link">GitHub</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/github/best_practices.html" class="sidebar-item-text sidebar-link">Best Practices for GitHub</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/github/citation.html" class="sidebar-item-text sidebar-link">Making repos citeable</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/github/actions.html" class="sidebar-item-text sidebar-link">GitHub Actions</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/github/onboarding_tools.html" class="sidebar-item-text sidebar-link">Onboarding Tools</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/github/secrets.html" class="sidebar-item-text sidebar-link">Keeping Secrets Secret</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../content/project_management/index.html" class="sidebar-item-text sidebar-link">Project Management</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/project_management/github_project_boards.html" class="sidebar-item-text sidebar-link">GitHub Project Boards</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/508_compliance.html" class="sidebar-item-text sidebar-link">508 Compliance</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/resources.html" class="sidebar-item-text sidebar-link">Resources</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#aims" id="toc-aims" class="nav-link active" data-scroll-target="#aims">Aims:</a></li>
  <li><a href="#standard-file-structure" id="toc-standard-file-structure" class="nav-link" data-scroll-target="#standard-file-structure">Standard file structure:</a></li>
  <li><a href="#structure-and-syntax-of-code" id="toc-structure-and-syntax-of-code" class="nav-link" data-scroll-target="#structure-and-syntax-of-code">Structure and syntax of code:</a></li>
  <li><a href="#dependencies" id="toc-dependencies" class="nav-link" data-scroll-target="#dependencies">Dependencies</a></li>
  <li><a href="#dates" id="toc-dates" class="nav-link" data-scroll-target="#dates">Dates</a></li>
  <li><a href="#assignments" id="toc-assignments" class="nav-link" data-scroll-target="#assignments">Assignments</a></li>
  <li><a href="#spaces" id="toc-spaces" class="nav-link" data-scroll-target="#spaces">Spaces</a></li>
  <li><a href="#r-sections" id="toc-r-sections" class="nav-link" data-scroll-target="#r-sections">R Sections</a></li>
  <li><a href="#starting-a-new-project-with-best-practices" id="toc-starting-a-new-project-with-best-practices" class="nav-link" data-scroll-target="#starting-a-new-project-with-best-practices">Starting a new project with best practices:</a></li>
  <li><a href="#r-profile-options" id="toc-r-profile-options" class="nav-link" data-scroll-target="#r-profile-options">R profile options</a></li>
  <li><a href="#data-sharing" id="toc-data-sharing" class="nav-link" data-scroll-target="#data-sharing">Data sharing:</a></li>
  <li><a href="#attribution" id="toc-attribution" class="nav-link" data-scroll-target="#attribution">Attribution</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/nmfs-opensci/ResourceBook/edit/main/content/best_practices_coding/best_practices_r.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/nmfs-opensci/ResourceBook/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Best Coding Practices in R</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Best RACE-GAP Coding Practices Prepared by: Caitlin Allen Akselrud - NOAA Federal</p>
<section id="aims" class="level2">
<h2 class="anchored" data-anchor-id="aims">Aims:</h2>
<ul>
<li>To create and share reproducible, transparent, and transferable code. Specifically:</li>
<li>To maintain consistent file structure and coding syntax for ease of sharing and reading code.</li>
<li>To have thoroughly documented code, that is understandable by others and reproducible.</li>
<li>To implement version control measures and track coding changes.</li>
<li>To have others view code for quality control, implementing issue trackers, and correcting issues in a timely manner.</li>
</ul>
<p>Let go of your entrenched habits in favor of group consistency!</p>
</section>
<section id="standard-file-structure" class="level2">
<h2 class="anchored" data-anchor-id="standard-file-structure">Standard file structure:</h2>
<p>This file structure example is based on R code, and other softwares may have slightly different configurations. At a minimum, your file structure should generally be in keeping with Wilson et al.&nbsp;(2017, see Box 3). For R code and R projects, your file structure should minimally include:</p>
<p>|- project_name</p>
<p>|- - project_name.Rproj</p>
<p>|- - code</p>
<p>|- - data</p>
<p>|- - documentation</p>
<p>|- - figures</p>
<p>|- - functions</p>
<p>|- - output</p>
<p><strong>You may include subfolders within your folders, such as:</strong></p>
<p>|- project_name</p>
<p>|- - data</p>
<p>|- - - data_raw</p>
<p><strong>Or add a year folder for annual projects, such as:</strong></p>
<p>|- project_name</p>
<p>|- - [year]</p>
<p>|- - - code</p>
<p>|- - - [other standard subfolders]</p>
<p><strong>You may also wish to add additional folders, such as:</strong></p>
<p>|- project_name</p>
<p>|- - presentations</p>
<p>|- - images</p>
<p>|- - reports</p>
<p>|- - paper</p>
<p>|- - license</p>
<p>|- - citation</p>
<p>|- - README</p>
<p>An example function for automatically building these folders:</p>
<pre><code># here are the names of the file folders you want to create:
dirs = c("code", "data", "documentation", "figures", "functions", "output")
for(i in 1:length(dirs)){
  if(dir.exists(dirs[i])==FALSE){
    dir.create(dirs[i])
  }
}</code></pre>
</section>
<section id="structure-and-syntax-of-code" class="level2">
<h2 class="anchored" data-anchor-id="structure-and-syntax-of-code">Structure and syntax of code:</h2>
<p>Code header metadata</p>
<p>Every .R file should start with a standard header. This header can be a comment in base format (#), in {roxygen} format (#’), or as an RMarkdown comment (— your comments —). You header should include, at a minimum:</p>
<pre><code># A short description of what this file is or does
# Created by: creator name
# Modified by: modifier name (if applicable)
# Contact: your@noaa.gov email address
# Created: date in yyyy-mm-dd format
# Modified: date in yyyy-mm-dd format</code></pre>
</section>
<section id="dependencies" class="level2">
<h2 class="anchored" data-anchor-id="dependencies">Dependencies</h2>
<p>It is important to track all packages and package versions used in your code. Current recommendations are to use the {renv} package: https://rstudio.github.io/renv/articles/renv.html</p>
<ul>
<li>At the start of a project, run: <code>renv::init()</code></li>
<li>During a project, run: <code>renv::snapshot()</code></li>
<li>When reopening the project or opening on a different computer, run: <code>renv::restore()</code></li>
<li>You will need to make sure you have a copy of the <code>.RProfile</code> file and the <code>renv.lock</code> files, and that you share those files when sharing your code with others or between computers.</li>
</ul>
<p>You should load all packages and libraries required in your script at the top of your script, not throughout. Naming conventions and coding style All names should be descriptive. Not descriptive: <code>var1</code>, <code>file1.R</code> Better: <code>cpue</code>, <code>cpue_calc.R</code> Best: <code>cpue_kg</code>, <code>cpue_calc_from_raw_data.R</code></p>
<p>Use snake_case, all lowercase and spaces replaced with underscores (not periods, and definitely not spaces). * File names * Use snake_case (underscores, not periods, and definitely never spaces): * lowercase_and_underscore.R</p>
<p>Use YYYY-MM-DD for any dates in file names. It can be helpful to use dates for 1) original data download, 2) files that change (for example, based on code runs), 3) to order items systematically in a folder, or 4) versions of files:</p>
<ul>
<li><code>orig_data_2020-12-01.csv</code></li>
<li><code>formatted_data_2020-12-02.csv</code></li>
<li><code>2020-12-20_FirstLastName_XYZConf.pptx</code></li>
</ul>
<p>Use descriptive names. For example, it is helpful to include <code>datasource_briefdescription_firstyear_lastyear_version_date.csv</code>: * <code>racebt_pollock_2010_2020_v_2020-12-01.csv</code> * <code>Origdata_racebt_pollock_2010_2020_v_2020-12-01.csv</code></p>
<p>Use numbers to identify the order items should be in for your fellow human readers. For example, this can be helpful if you and your colleagues expect to find files saved in a predictable order: * <code>1_intro_map_of_study_area.jpg</code> * <code>2_intro_map_of_stations_surveyed.jpg</code> * <code>3_method_net_diagram.jpg</code></p>
<p>It is better to have a longer filename than something nonsensical, nondescript, or only makes sense to you (e.g., pollock20.csv). However, be mindful that it is possible to have file names that are too long and you must balance descriptiveness with succinctness. Some functions in R will require paths or file names to be below a certain character limit (often around 256 characters).</p>
<p>When in doubt, defer to Jenny Bryan: <a href="https://speakerdeck.com/jennybc/how-to-name-files">https://speakerdeck.com/jennybc/how-to-name-files</a> * Object names * Short, but descriptive is ideal here. Again, use snake_case (lowercase with underscores between words, and not periods because they can cause problems in certain packages and functions).</p>
<p>Do not use reserved object and base R function names. Here are some common names that can cause problems: * c: <code>c()</code> is a function for concatenate, so do not use ‘c’ as a parameter or variable name. * T and F: these are boolean <code>TRUE</code> and <code>FALSE</code>, respectively. Note: Use TRUE and FALSE rather than T or F because some functions and packages can be picky and the former are much clearer. * t and f: <code>t()</code> and <code>f()</code> are the functions for t-tests and f-tests(). * plot: <code>plot()</code> is a base R function for creating a plot. A common mistake is to name a plot object ‘plot’. Instead, use something more descriptive (e.g., <code>study_map_plot</code> or <code>figure_*</code>).</p>
<p>Descriptive: for multiple datasets, use something like: <code>squid_dat</code> or <code>env_dat</code> rather than: <code>dat1</code> or <code>dat2</code></p>
<p>When reading in data files, there is a <code>{tidyverse}</code> package to correct names: <code>rename_all(tolower)</code>. The <code>{janitor}</code> package is also an excellent and expedient way to convert column names to follow Tidy data conventions.</p>
<p>Note: for tracking derived versus original data column names, it is best to call in all data being used, keeping all original and raw data in a raw data sub-folder. Then, processed data happens in a separate function and goes into a separate processed data sub-folder.</p>
<p>Some people use all caps for a parameter that is fixed in the global environment. This is ok, but please define the parameter at the top of the script, and note that it is a fixed value. For example: * <code>SELEX &lt;- 0.5 # selectivity is fixed at 0.5</code></p>
<p>Some people prefer to capitalize the first letter of an object when turning something into a factor. This is fine. E.g., age as a continuous variable and Age as a grouped factor for plotting. Function names Use snake_case for function names (lowercase with underscores between words, and not periods because they can cause problems with package functions). <code>descriptive_function_name</code> is great. * Naming the function with an <code>f_</code> at the start is even better for clarity to other users and can make finding the function easier: <code>f_calc_catchability</code> If using a specific package for a function that may have the same name among packages, the best practice is to use <code>package::function()</code>.</p>
</section>
<section id="dates" class="level2">
<h2 class="anchored" data-anchor-id="dates">Dates</h2>
<p>Always use the international convention for dates: YYYY-MM-DD. This allows files to be stored and sorted easily, as well as limit confusion on which number is for the year, the month, or the day. Note that if this fill is being written for a single digit month or day, we use a “0” to fill the space (e.g., “2021-01-02”).</p>
</section>
<section id="assignments" class="level2">
<h2 class="anchored" data-anchor-id="assignments">Assignments</h2>
<ul>
<li>Use &lt;- instead of = when assigning a data type. Reserve = for use within function designations.</li>
<li>Good: <code>pop_dy &lt;- f_get_pop(growth_rate = 0.3, carrying_cap = 10000)</code></li>
<li>Works, but is bad practice: <code>pop_dy = f_get_pop(growth_rate = 0.3, carrying_cap = 10000)</code></li>
<li>Someone will cry: <code>x=foo.fxn(r=0.3, K=10000)</code></li>
</ul>
</section>
<section id="spaces" class="level2">
<h2 class="anchored" data-anchor-id="spaces">Spaces</h2>
<ul>
<li>Place spaces around all binary operators (<code>=</code>, <code>+</code>, <code>-</code>, <code>&lt;-</code>, etc.).</li>
<li>Do not place a space before a comma, but always place one after a comma.</li>
<li>Detailed examples and additional recommendations are available in the tidyverse style guide.</li>
</ul>
</section>
<section id="r-sections" class="level2">
<h2 class="anchored" data-anchor-id="r-sections">R Sections</h2>
<ul>
<li>Use R sections to create outline sections with comments:</li>
<li>Use Ctrl+Shift+R to create outline sections (e.g., # — your section —).</li>
<li>Use Ctrl+Shift+O to see the outline of the script. This will help organize the script and make it easy for others to follow the script.</li>
<li>Please make a general description of the section such as: “packages”, “load data”, “data processing”, “model”, “results”, “graphics” are all good, short, descriptive names.</li>
<li>The developer can always create additional subsections within each section by adding a * before the section name (e.g., # — * your subsection—).</li>
</ul>
<p>For example:</p>
<pre><code># --- Load Libraries ---

# --- Source Scripts ---
# --- * Load Data ---
# --- * Load Functions ---

# --- Preliminary Analysis ---

# --- Model 1 ---
# --- * Save Results ---
# --- * Graphs ---</code></pre>
</section>
<section id="starting-a-new-project-with-best-practices" class="level2">
<h2 class="anchored" data-anchor-id="starting-a-new-project-with-best-practices">Starting a new project with best practices:</h2>
<ul>
<li>Use R Projects. R experts keep all the files associated with a project together — input data, R scripts, analytical results, figures. This is such a wise and common practice that RStudio has built-in support for projects.</li>
<li>Use standard file structure. See the Standard file structures section.</li>
<li>Do NOT use fixed paths. Refer to the {here} package and use <code>here::here("mydir", "myfile")</code> types of file specifications.</li>
<li>Do NOT save the R environment (reproducible code should run start to end without needing to load the environment).</li>
<li>Include a header with developer information at the top of each script. See the Code header section.</li>
<li>Annotate code generously for clarity. Add comments to lines for anything that might be tricky, confusing, or where the calculation comes from a specific source or paper.</li>
<li>Include all of dependencies</li>
<li>Please limit dependencies to packages/libraries actually being use.</li>
<li>Use R sections. See the R Sections section.</li>
<li>Use modular coding practices (functions!).</li>
<li>Build in regular checks to ensure the script is doing what it is supposed to do {testthat} package: https://testthat.r-lib.org/; https://cran.r-project.org/web/packages/testthat/testthat.pdf</li>
<li>Use version control.</li>
<li>Use the tidyverse style guide (or {styler} package), so the code has consistent formatting.</li>
<li>Strongly preferred practices</li>
<li>Use Git, GitHub, and/or GitLab for version control; see GitHub use section below.</li>
<li>When prepping a package for distribution, it is up to the author as to what dependencies they wish to include, or if they prefer to work exclusively in base R coding language.</li>
<li>Converting old code to best practices:</li>
<li>If you are converting old code to a new project, please follow the below guidance in addition to the guidance in the Starting a new project with best practices section.</li>
<li>Create an R Project (if one does not exist).</li>
<li>Set up standard file structure (to the extent possible) and organize files into appropriate folders. See the Standard file structures section.</li>
<li>Correct any paths that were written to local fixed directories (or “fixed” paths). Refer to the {here} package or getwd().</li>
<li>Include your header and dependencies.</li>
<li>Only include libraries you actually use.</li>
<li>Check the code and note any dependencies that may no longer work, result in errors, or are deprecated (no longer maintained or updated in favor of a newer package). Where possible, replace the use of these packages.</li>
<li>Add sections to the code for clarity (to the extent possible). See R sections.</li>
<li>Add notes within the code for clarity (to the extent possible).</li>
<li>For consistent formatting, select all your code and reformat using Code &gt; Reformat code (or ctrl + shift + a). Or you can run the {styler} package, so your code has consistent formatting with the R Style Guide.</li>
<li>Old non-R code to new R code</li>
<li>When creating new code based on code written in another language, it’s important to compare results of the new R code with the outputs of the previous code. It is important to test whether the two pieces of code (non-R and R) are producing the same outputs. If not, it is important to understand and document the differences.</li>
<li>It is best to create new R code that exactly replicates the original code, and then do updates and corrections to the new code, as needed, documenting where changes have been made.</li>
<li>Maintaining and sharing code:</li>
<li>Writing code for other people/computers</li>
<li>Create packages for code that are going to consistently be used or may be needed by others.</li>
<li>When writing a code or package for a wide audience/machines, check the code works using a virtual machine, with programs like Docker: https://www.docker.com/.</li>
<li>All packages can include the developer’s ORCID ID (https://orcid.org/).</li>
<li>Provide visual progress updates, so another user knows the code is running properly, even if it takes a long time.</li>
<li>Progress bar: https://ryouready.wordpress.com/2009/03/16/r-monitor-function-progress-with-a-progress-bar/. <code>print(paste(“some note about code progress”)</code> is also acceptable.</li>
<li>Options that rely on the code running on an open computer to execute are not encouraged (e.g., {beepr} package), as they may cause code to error out before completion.</li>
<li>If code takes a long time to run, it is helpful to annotate that in the code notes, in the script header, or to print a message to the user during the run.</li>
<li>Test the functions in the script (http://r-pkgs.had.co.nz/tests.html)</li>
</ul>
</section>
<section id="r-profile-options" class="level2">
<h2 class="anchored" data-anchor-id="r-profile-options">R profile options</h2>
<ul>
<li>Common example: machine precision settings are changed.</li>
<li>If changes are made to the options in profile, it must be specified in the code and documentation.</li>
<li>Build in a check to verify the user settings against the needed settings.</li>
<li>Save a record of what the profile options are.</li>
<li>It is recommended to not manually change options and to have the code make changes in the script.</li>
</ul>
</section>
<section id="data-sharing" class="level2">
<h2 class="anchored" data-anchor-id="data-sharing">Data sharing:</h2>
<ul>
<li>We often do not keep copies of raw data on sites like GitHub (too much storage). Instead, please have files in a space that is widely accessible to the group on a shared drive. Specify in the code notes where those files are.</li>
<li>If outside collaborators need access for authorized uses, another option is Google Drive (to automate downloads or otherwise access such data from R; see https://googledrive.tidyverse.org/](https://googledrive.tidyverse.org/)). To officially archive data, please see the Archiving section.</li>
</ul>
</section>
<section id="attribution" class="level2">
<h2 class="anchored" data-anchor-id="attribution">Attribution</h2>
<p>Adapted from the Best AFSC RACE-GAP Coding Practices Guidelines compiled by Caitlin Allen Akselrud, Emily Markowitz, and others.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../content/best_practices_coding/index.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Coding Best Practices</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../content/best_practices_coding/testing_and_review.html" class="pagination-link">
        <span class="nav-page-text">Testing and Review</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">This work is in the Public Domain <a href="https://creativecommons.org/publicdomain/zero/1.0/">CC-1.0</a></div>   
    <div class="nav-footer-right">This page is built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</body></html>